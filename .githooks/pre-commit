#!/bin/bash

# Pre-commit hook for blog post validation
# Copy this to .git/hooks/pre-commit and make executable

echo "üîç Running blog post validation..."

# Check if Node.js is available
if ! command -v node &> /dev/null; then
    echo "‚ùå Node.js is required but not installed"
    exit 1
fi

# Run validation script
if [ -f "validate-blog-posts.js" ]; then
    node validate-blog-posts.js
    VALIDATION_EXIT_CODE=$?
    
    if [ $VALIDATION_EXIT_CODE -ne 0 ]; then
        echo ""
        echo "‚ùå Blog post validation failed!"
        echo "Please fix the errors above before committing."
        echo ""
        echo "Quick fixes:"
        echo "1. Run: node fix-blog-rendering.js"
        echo "2. Update postRegistry.js with missing entries"
        echo "3. Ensure filenames match their slugs"
        echo ""
        exit 1
    fi
else
    echo "‚ö†Ô∏è  Blog validation script not found - skipping validation"
fi

echo "‚úÖ Blog posts validated successfully"